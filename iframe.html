<!DOCTYPE html>
<html>
  <head>
    <title>Two-way iframe</title>
  </head>
  <body>
    <h1 id="title">Iframe ready</h1>
    <button id="send">Send message to parent</button>

    <script>
      // 1️⃣ Receive messages from parent
      window.addEventListener('message', (event) => {
        console.log('Received from parent:', event.data);

        if (event.data?.title) {
          document.getElementById('title').innerText = event.data.title;
        }
      });

      // 2️⃣ Send messages to parent
      document.getElementById('send').addEventListener('click', () => {
        window.parent.postMessage(
          { status: 'clicked', time: Date.now() },
          window.location.origin
        );
      });

      // 3️⃣ Notify parent that iframe is ready
      window.parent.postMessage(
        { status: 'ready' },
        window.location.origin
      );
    </script>
  </body>
</html>
